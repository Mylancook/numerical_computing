\lab{Git}{Git}
\label{appendix:git}
\objective{
Computer code is delicate.
A rogue or clumsy programmer can easily damage a program with a simple spelling error.
Maintaining a working product is therefore a serious endeavor in software development, requiring checks, collaboration, and careful coordination.
\emph{Git} is a version control system that facilitates code development involving multiple contributors.
It is commonly used to manage large projects, especially open-source projects, but it can also be used for personal code storage and management.
In this appendix we introduce Git and Bitbucket, a web-based hosting service for Git.
This tutorial does not require any previous programming experience.
}

% This appendix is meant to be general and not provide classroom-specific instructions. See byuacmegit.tex in this folder for our specific instructions.

\section*{Overview} % =========================================================

The main idea behind Git is that the master copy (the official version) of a program's code is kept in the cloud in a \emph{repository}.
All certified contributors can \emph{clone} the repository onto their machine so that they can make changes to the code.
All changes are then submitted to the cloud, reviewed, and approved before the changes are \emph{merged} into the master copy.

If two contributors make changes to the same piece of code, it may create a \emph{merge conflict}, which must be resolved before any changes can be merged in.
For small repositories with few collaborators, merge conflicts are very rarely a problem.
The main issue then becomes understanding how to communicate edits between a local copy and the master copy in the cloud.

\subsection*{Installation} % --------------------------------------------------

Download the appropriate installer at \url{http://git-scm.com/downloads}.
Git is underlying software that will be accessed through the command line, so the installation will not create a new visible application.
On Windows machines, however, it will also download a terminal-like interface just for Git called \emph{git bash}.
Most Linux and Macintosh machines come with Git pre-installed.

\subsection*{Creating a New Repository} % -------------------------------------

A repository is the place where all of the code for an associated project resides.
Many different companies have websites for hosting Git repositories.
\href{https://github.com/}{Github}, \href{https://bitbucket.org/}{Bitbucket}, and \href{https://gitlab.com/}{Gitlab} are just a few of the options.
Github is by far the most popular, especially for open-source projects, but Bitbucket offers free private repositories.

There are two ways to set up a new repository: by importing an existing repository, or by starting from scratch.
Imported repositories are ready to be cloned, but new or empty repositories require a little more setup.

Once a new or empty repository has been created on-line, it must be manually connected to a local folder on a computer.
On your machine, navigate through the terminal to the location where you would like the repository to reside locally.
Then execute the following bash commands:

\begin{lstlisting}[language=bash]
$ mkdir /path/to/your/project       # Make a new directory for the repository.
$ cd /path/to/your/project          # Enter the new directory.
$ git init                          # Turn the directory into a Git folder.
# Finally, connect the local folder to the repository in the cloud.
$ git remote add origin https://<host website>/<username>/<repo_name>
\end{lstlisting}

The key word ``origin'' now references the repository in the cloud

\subsection*{Cloning a Repository} % ------------------------------------------

Now the new repository is set up in the cloud, but we still need to clone it to a machine.

Open up a command terminal (on Windows, use the Git bash application).
Navigate to the directory where you want to place the repository.
% On the lab computers, this should be in the myacmeshare directory.
On Bitbucket, go to the repository page.
In the menu on the left, click ``Clone'' and copy the text that pops up (it should like like \li{git clone https://bitbucket.org/username/repo}).

In the command terminal, run the command
\li{\$ git clone <repo_url> <directory_name>}, where \li{<repo\_url>} is the web address to the new repository and \li{<directory_name>} is the name of the directory you want to create.
% For example, the command
% \li{\$ git clone https://bitbucket.org/shanemcq/volume2 Volume2} will clone the Git repository ``bitbucket.org/shanemcq/volume2'' into a new folder called ``Volume2'' (if you try this exact command, you will probably get a ``does not exist'' error.)
You will probably be asked to enter in your Bitbucket password to authenticate the cloning, since the repository is private.
% 
% This command creates a folder and places all files from the repository in that folder.

\subsection*{Collaboration} % -------------------------------------------------

To give someone else access to the repository, they must also have a Bitbucket account.
Click the ``Repositories'' menu and select the new repository, then click the ``Send Invitation'' button.
Enter your collaborator's email address or Bitbucket user name. %For Volume I, enter ``jesslm83@gmail.com''. For Volume II, enter ``shanemcq18@gmail.com''.
Select the level of authorization you want this author to have (a TA or professor should have at least ``write'' privileges).
%Mark the ``admin'' box to give the TAs administrator access.
Finally, click the ``Share'' button.

% This should be the main section of the lab.
\section*{Using Git} % ========================================================

Git is very similar to Google Drive, but synchronization with the cloud must be done manually. You'll have to do this several times to get used to it. To edit your repository, execute the following commands:

In the command line, navigate to the cloned copy of the repository on your machine (on Windows machines, use the Git command prompt).
Run the command git pull origin master. This updates the copy of the repository on the machine.
Make any changes to the files in the repository (this is the part when you make new files, edit code, etc.).
To save changes, run the following commands.
Run git add <filename> for each of the files that you want stored (or submitted) in the master repository.
After all of the desired files have been added, run the command git commit -m ``<type a message here>''. This packs the changes together.
Finally, run the command git push origin master. This updates the master copy of the repository hosted by Bitbucket.

To summarize, here all of the Git commands you absolutely need to know:

\begin{table}[H]
\begin{tabular}{c|l}
Command & Description \\ \hline
\li{git pull origin master} & Pull down changes from the master copy (synchronize).\\
\li{git add <filename(s)>} & Add a file to the list of things to be synced.\\
\li{git commit -m <<\"<message>\">>} & Package up the changes and give them a label (checkpoint).\\
\li{git push origin master} & Push committed changes up to the master copy\\
\li{git status} & See which files have been changed and which have been added to the commit.\\
\li{git diff <filename>} & See the changes made on a particular file since the latest commit.\\
\li{git checkout -- <filename>} & Revoke the changes made since the last commit.
\end{tabular}
\end{table}

If you have any questions about a Git command or its usage, run the command git by itself to see a list of common commands. Run the command git help <command> to pull up documentation on a particular command (press ``q'' to exit).

\begin{comment}
\section*{Lab Submission and File Organization} % =============================

Since the repositories for each class are entirely separate, we will use the convention repository / lab\# / solutions.py.
As long as we set up the repositories correctly online, the repository folder on your machine can be called whatever you want.

Git is designed to store source code files, not large data files.
When a lab uses a large data set, download the data and put it in your repository folder, but do not add/commit the data file.
That way, you can use the data without pushing it up to the cloud.

Please do not submit anything other than the source code needed to run your solutions.
% Do not submit any binary files (.pdf, .npz, etc).
% Do not submit any of the datasets used in the lab. The TAs will provide data when grading.
No file you submit should ever execute any code in its main body.
The only things you should include in the main body of the file are import statements, function declarations, and class declarations.
Anything else (tests, etc.) should be placed in an \li{if __name__ == "__main__":} block at the end of the file so that it is not executed when we import the file for grading.
% Test your solutions! Little mercy will be granted for labs that don't run at all.
\end{comment}

\section*{Branches} % =========================================================

For those of you who are already familiar with Git, you may want to create several branches and merge them in with the master branch manually. This is fine, but keep in mind that the TA's will pull from the master branch to get your submissions and push to the master branch to give feedback. If you're new to Git, don't worry about branches.

\url{https://xkcd.com/1597/}
\url{https://xkcd.com/1296/}
